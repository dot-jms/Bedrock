<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bedrock Games</title>
<link rel="icon" href="favicon.png" type="image/png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
  /* (Kept your styling; trimmed comments for brevity) */
  :root{--bg:#04040a;--bg-secondary:#0a0a12;--muted:#9aa3a8;--muted-hover:#b8c1c6;--accent:#8ef6c1;
  --accent-hover:#a8ffdb;--purple-strong:rgba(150,85,255,0.25);--purple-glow:rgba(150,85,255,0.15);
  --tile-purple:rgba(138,75,230,0.14);--tile-purple-hover:rgba(138,75,230,0.28);--glass-border:rgba(255,255,255,0.08);
  --glass-bg:rgba(255,255,255,0.02);--shadow-strong:0 25px 80px rgba(0,0,0,0.7);--shadow-medium:0 15px 50px rgba(0,0,0,0.4);
  --shadow-soft:0 8px 25px rgba(0,0,0,0.2);font-family:'Inter',system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  font-feature-settings:'liga' 1,'kern' 1;}

  html,body{height:100%;margin:0;background:var(--bg);color:#eef2f5;overflow-x:hidden;scroll-behavior:smooth}
  *{box-sizing:border-box} a{color:inherit;text-decoration:none}

  canvas#bg{position:fixed;inset:0;z-index:0;pointer-events:none;display:block;filter:brightness(1.1)}
  .vignette{position:fixed;inset:0;z-index:1;pointer-events:none;background:
    radial-gradient(45% 45% at 15% 15%, rgba(150,85,255,0.2), transparent 25%),
    radial-gradient(55% 55% at 85% 85%, rgba(122,58,210,0.16), transparent 30%),
    radial-gradient(35% 35% at 50% 50%, rgba(140,246,193,0.08), transparent 20%),
    linear-gradient(180deg, rgba(8,6,14,0.06), rgba(2,2,6,0.12));mix-blend-mode:screen;animation:vignette-pulse 8s ease-in-out infinite;}
  @keyframes vignette-pulse{0%,100%{opacity:1}50%{opacity:0.85}}

  .wrap{position:relative;z-index:2;min-height:100vh;display:flex;align-items:flex-start;justify-content:center;padding:32px;animation:fade-in .6s ease-out}
  @keyframes fade-in{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

  .card{width:100%;max-width:1400px;padding:24px;border-radius:20px;
    background:linear-gradient(135deg, rgba(255,255,255,0.12) 0%, rgba(255,255,255,0.02) 100%), linear-gradient(180deg,var(--bg-secondary),var(--bg));
    border:1px solid var(--glass-border);box-shadow:var(--shadow-strong);position:relative;overflow:visible;backdrop-filter: blur(20px)}

  .card::before{content:"";position:absolute;inset:-12px;border-radius:24px;z-index:-1;background: linear-gradient(135deg,var(--purple-strong),var(--purple-glow));filter: blur(20px);animation:glow-pulse 4s ease-in-out infinite}
  @keyframes glow-pulse{0%,100%{opacity:0.8}50%{opacity:1}}

  .hdr{display:flex;align-items:center;gap:16px;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid rgba(255,255,255,0.06)}
  .logo{width:60px;height:60px;border-radius:12px;background:linear-gradient(135deg,#1a1a24,#0f1419);display:grid;place-items:center;color:var(--accent);font-weight:700;box-shadow:var(--shadow-medium);border:1px solid rgba(255,255,255,0.1)}
  .logo img{width:50px;height:50px;border-radius:10px;display:block}
  h1{margin:0;font-size:22px;font-weight:800;background:linear-gradient(135deg,#fff,var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  .muted{color:var(--muted);font-size:14px;font-weight:500}

  .controls{margin-left:auto;display:flex;gap:10px;align-items:center}
  .stealth-btn{padding:8px 12px;border-radius:8px;border:1px solid rgba(255,100,100,0.3);background:rgba(255,100,100,0.1);color:#ffaaaa;font-weight:600;cursor:pointer;font-size:13px;transition:all .2s}
  .stealth-btn:hover{background:rgba(255,100,100,0.2);border-color:rgba(255,100,100,0.5);color:#ffcccc;transform:translateY(-1px)}
  .back-btn{border-color:rgba(100,100,255,0.3);background:rgba(100,100,255,0.1);color:#aaaaff}
  .back-btn:hover{background:rgba(100,100,255,0.2);border-color:rgba(100,100,255,0.5);color:#ccccff}

  .games-content{display:grid;grid-template-columns:280px 1fr;gap:24px}
  .categories{padding:16px;border-radius:16px;background:linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.04);backdrop-filter: blur(10px);height:fit-content}
  .category-btn{display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:12px;border:1px solid transparent;background:transparent;color:inherit;cursor:pointer;font-weight:600;font-size:14px;width:100%;margin-bottom:8px;transition:all .2s;text-align:left}
  .category-btn:hover{background:rgba(255,255,255,0.05);border-color:rgba(255,255,255,0.08);transform:translateY(-1px);color:var(--muted-hover)}
  .category-btn.active{background:linear-gradient(135deg, rgba(142,246,193,0.08), rgba(140,90,240,0.08));color:var(--accent);border-color:rgba(142,246,193,0.2);box-shadow:0 12px 40px rgba(140,90,240,0.1);transform:translateY(-2px)}

  .games-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}
  .game-card{border-radius:16px;padding:20px;border:1px solid rgba(255,255,255,0.06);min-height:140px;display:flex;flex-direction:column;justify-content:space-between;cursor:pointer;transition:all .25s;background:linear-gradient(135deg,var(--tile-purple),rgba(138,75,230,0.08)),linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));backdrop-filter:blur(10px);position:relative;overflow:hidden}
  .game-card::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent);transition:left .5s}
  .game-card:hover::before{left:100%}
  .game-card:hover{background:linear-gradient(135deg,var(--tile-purple-hover),rgba(138,75,230,0.16)),linear-gradient(180deg,rgba(255,255,255,0.04),rgba(255,255,255,0.02));transform:translateY(-8px) scale(1.02);box-shadow:0 25px 60px rgba(120,60,220,0.15);border-color:rgba(255,255,255,0.12)}
  .game-card h3{margin:0 0 8px 0;font-size:17px;color:#e8d9ff;font-weight:700;display:flex;align-items:center;gap:8px}
  .game-card p{margin:0 0 16px 0;color:var(--muted);font-size:14px;line-height:1.4;font-weight:500;flex-grow:1}
  .game-meta{display:flex;justify-content:space-between;align-items:center;font-size:12px;color:var(--muted)}
  .play-btn{padding:8px 16px;border-radius:8px;border:0;background:rgba(142,246,193,0.1);color:var(--accent);font-weight:700;cursor:pointer;transition:all .2s;font-size:13px}
  .play-btn:hover{background:rgba(142,246,193,0.2);transform:translateY(-1px)}

  .category-section h2{margin:0 0 16px 0;font-size:20px;font-weight:700;color:var(--accent)}
  .search-bar{width:100%;padding:12px 16px;border-radius:12px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:#eef2f5;font-size:14px;margin-bottom:16px;transition:all .2s}
  .search-bar:focus{outline:none;border-color:rgba(142,246,193,0.3);background:rgba(255,255,255,0.04)}
  .search-bar::placeholder{color:var(--muted)}

  /* debug bar */
  #debugBar{position:fixed;left:12px;bottom:12px;background:rgba(0,0,0,0.6);color:#fff;padding:6px 10px;border-radius:8px;font-size:12px;z-index:9999;opacity:0.9}
  @media (max-width:920px){.games-content{grid-template-columns:1fr}.categories{order:1;margin-top:20px}.games-grid{grid-template-columns:1fr}.wrap{padding:20px}.card{padding:20px}}
  @media (max-width:480px){.wrap{padding:16px}.card{padding:16px}.controls{flex-direction:column;gap:8px}}
</style>
</head>
<body>
  <canvas id="bg" aria-hidden="true"></canvas>
  <div class="vignette" aria-hidden="true"></div>

  <div class="wrap">
    <div class="card" id="cardRoot">
      <div class="hdr">
        <div class="logo"><img src="favicon.png" alt="Bedrock logo"></div>
        <div>
          <h1>Bedrock Games</h1>
          <div class="muted">Your digital playground</div>
        </div>

        <div class="controls">
          <button class="stealth-btn" onclick="emergencyClose()" title="Quick close (Ctrl+W)">‚ö° Quick Exit</button>
          <button class="stealth-btn back-btn" onclick="goPortal()" title="Back to portal">‚Üê Portal</button>
        </div>
      </div>

      <div class="games-content">
        <div class="categories">
          <input type="text" class="search-bar" placeholder="Search games..." id="searchBar">

          <button class="category-btn active" data-category="all">üéÆ All Games</button>
          <button class="category-btn" data-category="arcade">üëæ Arcade</button>
          <button class="category-btn" data-category="puzzle">üß© Puzzle</button>
          <button class="category-btn" data-category="strategy">üéØ Strategy</button>
          <button class="category-btn" data-category="multiplayer">üë• Multiplayer</button>
          <button class="category-btn" data-category="classic">üïπÔ∏è Classic</button>
          <button class="category-btn" data-category="creative">üé® Creative</button>
        </div>

        <div id="gamesContainer">
          <div class="category-section" data-category="all">
            <div class="games-grid" id="allGames"><!-- JS inject --></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="debugBar" style="display:none">DEBUG: page loaded</div>

<script>
/* ---------- starfield (same as portal) ---------- */
(function(){
  const canvas = document.getElementById('bg');
  const ctx = canvas.getContext('2d');
  let w = canvas.width = innerWidth, h = canvas.height = innerHeight;
  const STAR_COUNT = Math.floor((w*h)/2800);
  const stars = [];
  function rand(min,max){ return Math.random()*(max-min)+min }
  for(let i=0;i<STAR_COUNT;i++) stars.push({x:Math.random()*w,y:Math.random()*h,z:rand(0.4,1.8),r:rand(1.2,4.5),vx:rand(-0.04,0.04),vy:rand(-0.08,0.08),t:Math.random()*15,color:Math.random()>0.85 ? 'rgba(142,246,193,0.8)' : 'white'});
  addEventListener('resize', ()=>{ w=canvas.width=innerWidth; h=canvas.height=innerHeight; });
  (function draw(){
    ctx.clearRect(0,0,w,h);
    const g = ctx.createRadialGradient(w/2,h/2,0,w/2,h/2,Math.max(w,h));
    g.addColorStop(0,'rgba(8,6,14,0.1)'); g.addColorStop(0.5,'rgba(4,4,10,0.2)'); g.addColorStop(1,'rgba(2,2,6,0.3)');
    ctx.fillStyle = g; ctx.fillRect(0,0,w,h);
    const t = Date.now()/2800;
    for(const s of stars){
      s.x += s.vx * (s.z*1.8);
      s.y += s.vy * (s.z*1.8);
      const tw = Math.abs(Math.sin(t + s.t)) * Math.abs(Math.cos(t*0.7 + s.t*0.5));
      if(s.x<0) s.x = w; if(s.x>w) s.x = 0; if(s.y<0) s.y = h; if(s.y>h) s.y = 0;
      ctx.beginPath();
      ctx.globalAlpha = 0.6 + 0.4 * s.z * (0.2 + tw*0.8);
      ctx.fillStyle = s.color; ctx.arc(s.x, s.y, s.r * s.z, 0, Math.PI*2); ctx.fill();
      if(s.r>3){ ctx.beginPath(); ctx.globalAlpha = 0.1 * s.z * tw; ctx.arc(s.x, s.y, s.r * s.z * 2, 0, Math.PI*2); ctx.fill(); }
      ctx.globalAlpha = 1;
    }
    requestAnimationFrame(draw);
  })();
})();

/* ---------- game data (unchanged) ---------- */
const games = [
  {name:"Slope",emoji:"‚ö°",description:"Roll down the slope and avoid obstacles in this addictive 3D game.",category:"arcade",url:"https://slope-game.github.io/",difficulty:"Medium"},
  {name:"Run 3",emoji:"üèÉ",description:"Navigate through space tunnels in this endless running adventure.",category:"arcade",url:"https://run-3.github.io/",difficulty:"Easy"},
  {name:"Chrome Dino",emoji:"ü¶ï",description:"The classic offline Chrome dinosaur game, but always available.",category:"arcade",url:"https://chromedino.com/",difficulty:"Easy"},
  {name:"Flappy Bird",emoji:"üê¶",description:"Navigate through pipes in this frustratingly fun flying game.",category:"arcade",url:"https://flappybird.io/",difficulty:"Hard"},
  {name:"2048",emoji:"üî¢",description:"Combine tiles to reach the elusive 2048 number in this math puzzle.",category:"puzzle",url:"https://2048game.com/",difficulty:"Medium"},
  {name:"Tetris",emoji:"üß±",description:"The timeless block-stacking puzzle that started it all.",category:"puzzle",url:"https://tetris.com/play-tetris",difficulty:"Medium"},
  {name:"Cut the Rope",emoji:"üç≠",description:"Feed candy to Om Nom by cutting ropes and solving physics puzzles.",category:"puzzle",url:"https://cuttherope.ie/",difficulty:"Easy"},
  {name:"Chess",emoji:"‚ôüÔ∏è",description:"Classic chess against AI or other players online.",category:"strategy",url:"https://www.chess.com/play/computer",difficulty:"Hard"},
  {name:"Checkers",emoji:"üî¥",description:"Strategic board game where you capture opponent's pieces.",category:"strategy",url:"https://www.gamesgames.com/game/checkers-classic",difficulty:"Medium"},
  {name:"Agar.io",emoji:"üéØ",description:"Grow your cell and consume others in this multiplayer battle.",category:"multiplayer",url:"https://agar.io/",difficulty:"Medium"},
  {name:"Slither.io",emoji:"üêç",description:"Become the longest snake in this multiplayer arena.",category:"multiplayer",url:"https://slither.io/",difficulty:"Easy"},
  {name:"Shell Shockers",emoji:"ü•ö",description:"Egg-based multiplayer shooter with various game modes.",category:"multiplayer",url:"https://shellshock.io/",difficulty:"Medium"},
  {name:"Pac-Man",emoji:"üëª",description:"The classic arcade maze game that defined a generation.",category:"classic",url:"https://www.google.com/doodles/30th-anniversary-of-pac-man",difficulty:"Easy"},
  {name:"Snake",emoji:"üêç",description:"Classic Nokia phone game - grow your snake and avoid walls.",category:"classic",url:"https://playsnake.org/",difficulty:"Easy"},
  {name:"Asteroids",emoji:"üöÄ",description:"Destroy asteroids and UFOs in this classic space shooter.",category:"classic",url:"https://freeasteroids.org/",difficulty:"Medium"},
  {name:"Minecraft Classic",emoji:"‚õèÔ∏è",description:"Build and create in the browser version of the legendary game.",category:"creative",url:"https://classic.minecraft.net/",difficulty:"Easy"},
  {name:"Draw.io",emoji:"‚úèÔ∏è",description:"Create diagrams, flowcharts, and drawings online.",category:"creative",url:"https://app.diagrams.net/",difficulty:"Easy"}
];

/* ---------- helpers ---------- */
function goPortal(){ try{ location.href='portal.html' }catch(e){ console.warn(e) } }
function emergencyClose(){
  try{ location.replace('about:blank'); }catch(e){
    // fallback: open simple blank page
    const w = window.open('about:blank', '_self'); if(w) w.document.write('<title>Blank</title>');
  }
}

/* open game in a new tab with a full-window iframe (stealth) */
function launchGame(url, name){
  try{
    const newWin = window.open('about:blank', '_blank', 'noopener');
    if(!newWin){
      alert('Popup blocked ‚Äî allow popups for this site or open the link manually.');
      return;
    }
    // write a small loader + iframe
    newWin.document.write(`
      <!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
      <title>${escapeHtml(name)}</title>
      <style>html,body{height:100%;margin:0;background:#000} .loading{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-family:Inter,Arial;text-align:center}</style>
      </head><body>
      <div class="loading">Loading ${escapeHtml(name)}‚Ä¶</div>
      <iframe src="${escapeAttr(url)}" style="width:100vw;height:100vh;border:0"></iframe>
      <script>const d=document;const l=d.querySelector('.loading');window.addEventListener('message',e=>{});window.addEventListener('load',()=>l && (l.style.display='none'));</script>
      </body></html>
    `);
    newWin.document.close();
  }catch(err){
    console.error('launchGame error', err);
    // fallback: open directly if writing fails
    window.open(url, '_blank', 'noopener');
  }
}

/* small escaping helpers for safety when writing innerHTML in new window */
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
function escapeAttr(s){ return String(s).replace(/"/g, '&quot;'); }

/* ---------- populate games + UI behavior ---------- */
function createGameCard(game){
  const card = document.createElement('div');
  card.className = 'game-card';
  card.setAttribute('role','button');
  card.tabIndex = 0;
  card.dataset.url = game.url;
  card.innerHTML = `
    <h3>${game.emoji} ${game.name}</h3>
    <p>${game.description}</p>
    <div class="game-meta">
      <span>Difficulty: ${game.difficulty}</span>
      <button class="play-btn" data-url="${game.url}" data-name="${game.name}">Play ‚Üí</button>
    </div>
  `;
  // click anywhere on card = play
  card.addEventListener('click', (e)=>{
    const url = card.dataset.url;
    launchGame(url, game.name);
  });
  // keyboard support
  card.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); launchGame(card.dataset.url, game.name); }
  });
  // play button specific (stop bubbling so card listener doesn't double-run)
  const btn = card.querySelector('.play-btn');
  btn.addEventListener('click', (ev)=>{
    ev.stopPropagation();
    launchGame(btn.dataset.url, btn.dataset.name);
  });
  return card;
}

function populateGames(list){
  const container = document.getElementById('allGames');
  container.innerHTML = '';
  if(!list || list.length === 0){
    container.innerHTML = '<div style="color:var(--muted);padding:12px">No games found.</div>';
    return;
  }
  list.forEach(g => container.appendChild(createGameCard(g)));
}

/* ---------- category + search wiring (after DOM ready) ---------- */
document.addEventListener('DOMContentLoaded', ()=>{
  const debugBar = document.getElementById('debugBar');
  debugBar.style.display = 'block';
  debugBar.textContent = 'DEBUG: DOMContentLoaded ‚Äî rendering games...';
  console.log('Bedrock Games: DOM ready ‚Äî populating');

  // populate all initially
  populateGames(games);

  // categories
  document.querySelectorAll('.category-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      document.querySelectorAll('.category-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      const cat = btn.dataset.category;
      const filtered = cat === 'all' ? games : games.filter(g => g.category === cat);
      populateGames(filtered);
      debugBar.textContent = `DEBUG: filtered -> ${cat} (${filtered.length})`;
    });
  });

  // search
  const search = document.getElementById('searchBar');
  search.addEventListener('input', (e)=>{
    const q = e.target.value.trim().toLowerCase();
    const filtered = games.filter(g => g.name.toLowerCase().includes(q) || g.description.toLowerCase().includes(q));
    populateGames(filtered);
    debugBar.textContent = `DEBUG: search -> "${q}" (${filtered.length})`;
  });

  // keyboard quick-exit: Ctrl+W
  document.addEventListener('keydown', (e)=>{ if(e.ctrlKey && (e.key === 'w' || e.key === 'W')) emergencyClose(); });

  // tiny UX: if page loaded directly (no auth), show debug but do nothing ‚Äî portal should handle auth
  debugBar.textContent += ' ‚Äî ready';
});

/* ---------- final note for caching issues ---------- */
/* If you change this file and Netlify doesn't show updates:
   1) Make sure the file is at the repo root named EXACTLY "games.html".
   2) Confirm Netlify deployed the latest commit (check deploy logs).
   3) Hard-refresh the page in your browser (Ctrl/Cmd+Shift+R) or open Incognito.
   4) You can also try loading https://your-site.netlify.app/games.html directly to verify.
*/
</script>
</body>
</html>
